<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">

	<h:head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	</h:head>
	
	<p:growl id="msg" showDetail="true" escape="false" />  
	
	<p:panel id="elegirButacaPanel">
		<h:panelGrid columns="6" cellpadding="5" id="elegirCantidadPanelGrid"
			style="width:auto !important">
			<h:outputLabel for="elegirCantidadMayores" value="Mayores" />
			<p:selectOneMenu id="elegirCantidadMayores"
				value="#{estadioController.cantidadMayores}" effect="fade">
				<f:selectItem itemLabel="0" itemValue="0" />
				<f:selectItem itemLabel="1" itemValue="1" />
				<f:selectItem itemLabel="2" itemValue="2" />
				<f:selectItem itemLabel="3" itemValue="3" />
				<f:selectItem itemLabel="4" itemValue="4" />
				<f:selectItem itemLabel="5" itemValue="5" />
				<f:selectItem itemLabel="6" itemValue="6" />
				<p:ajax event="valueChange"
					process="@this"  update="msg,elegirButacaPanel,:profileTabViewVendedor:showEntrada"
					partialSubmit="true" />
			</p:selectOneMenu>
			<h:outputLabel for="elegirCantidadMenores" value="Menores" />
			<p:selectOneMenu id="elegirCantidadMenores"
				value="#{estadioController.cantidadMenores}" effect="fade">
				<f:selectItem itemLabel="0" itemValue="0" />
				<f:selectItem itemLabel="1" itemValue="1" />
				<f:selectItem itemLabel="2" itemValue="2" />
				<f:selectItem itemLabel="3" itemValue="3" />
				<f:selectItem itemLabel="4" itemValue="4" />
				<f:selectItem itemLabel="5" itemValue="5" />
				<f:selectItem itemLabel="6" itemValue="6" />
				<p:ajax event="valueChange"
					process="@this" update="msg,elegirButacaPanel,:profileTabViewVendedor:showEntrada"
					partialSubmit="true" />
			</p:selectOneMenu>
			<h:outputLabel for="elegirCantidadJubilados" value="Jubilados" />
			<p:selectOneMenu id="elegirCantidadJubilados"
				value="#{estadioController.cantidadJubilados}" effect="fade">
				<f:selectItem itemLabel="0" itemValue="0" />
				<f:selectItem itemLabel="1" itemValue="1" />
				<f:selectItem itemLabel="2" itemValue="2" />
				<f:selectItem itemLabel="3" itemValue="3" />
				<f:selectItem itemLabel="4" itemValue="4" />
				<f:selectItem itemLabel="5" itemValue="5" />
				<f:selectItem itemLabel="6" itemValue="6" />
				<p:ajax event="valueChange"
					process="@this" update="msg,elegirButacaPanel,:profileTabViewVendedor:showEntrada"
					partialSubmit="true" />
			</p:selectOneMenu>
		</h:panelGrid>

		<h:panelGrid columns="2" cellpadding="5" id="elegirFestivalPanelGrid"
			style="width:auto !important"
			rendered="#{estadioController.cantidadElegida != null and estadioController.cantidadElegida != 0}">
			<h:outputLabel for="elegirFestival" value="Elija Festival" />
			<p:selectOneMenu id="elegirFestival"
				value="#{estadioController.festivalElegido}"
				converter="#{festivalConverter}" effect="fade">
				<f:selectItem itemLabel="Elija Festival" itemValue="" />
				<f:selectItems value="#{festivalController.items}" var="festival"
					itemLabel="#{festival.nombre}" itemValue="#{festival}" />
				<p:ajax event="valueChange"
					listener="#{estadioController.setFestivalElegido(festival)}"
					process="@this" oncomplete="window.location.reload()"
					partialSubmit="true" />
			</p:selectOneMenu>
		</h:panelGrid>

		<h:panelGrid columns="2" cellpadding="5" id="elegirDiaPanelGrid"
			style="width:auto !important"
			rendered="#{estadioController.cantidadElegida != null and estadioController.cantidadElegida != 0 and estadioController.festivalElegido.id != null}">
			<h:outputLabel for="elegirDia" value="Elija Dia" />
			<p:selectOneMenu id="elegirDia"
				value="#{estadioController.diaElegido}" converter="#{diaConverter}"
				effect="fade">
				<f:selectItem itemLabel="Elija Dia" itemValue="" />
				<f:selectItems value="#{estadioController.festivalElegido.dias}"
					var="dia" itemLabel="#{dia.nombre}" itemValue="#{dia}" />
				<p:ajax event="valueChange"
					listener="#{estadioController.setDiaElegido(dia)}" process="@this"
					oncomplete="window.location.reload()" partialSubmit="true" />
			</p:selectOneMenu>
		</h:panelGrid>

		<h:panelGrid columns="2" cellpadding="5" id="elegirSectorPanelGrid"
			style="width:auto !important"
			rendered="#{estadioController.cantidadElegida != null and estadioController.cantidadElegida != 0 and estadioController.festivalElegido.id != null and estadioController.diaElegido.id != null}">
			<h:outputLabel for="elegirSector" value="Elija Sector" />
			<p:selectOneMenu id="elegirSector"
				value="#{estadioController.sectorElegido}"
				converter="#{sectorConverter}" effect="fade">
				<f:selectItem itemLabel="Elija Sector" itemValue="" />
				<f:selectItems
					value="#{estadioController.getSectoresDisponiblesFromFestivalAndDia(estadioController.festivalElegido,estadioController.diaElegido)}"
					var="sector" itemLabel="#{sector.nombre}" itemValue="#{sector}" />
				<p:ajax event="valueChange"
					listener="#{estadioController.setSectorElegido(sector)}"
					process="@this" oncomplete="window.location.reload()"
					partialSubmit="true" />
			</p:selectOneMenu>
		</h:panelGrid>

		<h:panelGrid columns="2" cellpadding="5" id="elegirFilaPanelGrid"
			style="width:auto !important"
			rendered="#{estadioController.cantidadElegida != null and estadioController.cantidadElegida != 0 and estadioController.festivalElegido.id != null and estadioController.diaElegido.id != null and estadioController.sectorElegido.id != null}">
			<h:outputLabel for="elegirFila" value="Elija Fila" />
			<p:selectOneMenu id="elegirFila"
				value="#{estadioController.filaElegida}"
				converter="#{filaConverter}" effect="fade">
				<f:selectItem itemLabel="Elija Fila" itemValue="" />
				<f:selectItems
					value="#{estadioController.getFilasDisponiblesFromSector(estadioController.sectorElegido)}"
					var="fila" itemLabel="#{fila.nombre}" itemValue="${fila}" />
				<p:ajax event="valueChange"
					listener="#{estadioController.setFilaElegida(fila)}"
					process="@this" oncomplete="window.location.reload()"
					partialSubmit="true" />
			</p:selectOneMenu>
		</h:panelGrid>

		<h:panelGrid columns="2" cellpadding="5" id="elegirAsientoPanelGrid"
			style="width:auto !important"
			rendered="#{estadioController.cantidadElegida != null and estadioController.cantidadElegida != 0 and estadioController.festivalElegido.id != null and estadioController.diaElegido.id != null and estadioController.sectorElegido.id != null and estadioController.filaElegida.id != null}">
			<h:outputLabel for="elegirAsiento" value="Elija Asiento" />

			<p:pickList id="elegirAsiento" 
				value="#{estadioController.asientosElegidos}" var="asiento"
				effect="bounce" itemValue="#{asiento}" itemLabel="#{asiento.nombre}"
				showSourceControls="true" showTargetControls="true" showCheckbox="true" 
				converter="#{asientoConverter}">
				
				<f:facet name="sourceCaption">Disponibles</f:facet>  
    		    <f:facet name="targetCaption">Elegidos</f:facet>
    		    
    		    <p:ajax event="transfer" listener="#{estadioController.onTransfer}" update="msg,elegirButacaPanel,:profileTabViewVendedor:showEntrada" 
    		     
    		    /> 
				
				<p:column>
					#{asiento.nombre}
				</p:column>

			</p:pickList>

		</h:panelGrid>
		<h:panelGrid columns="2" cellpadding="5" id="botonesPanelGrid"
			style="width:auto !important"
			rendered="#{estadioController.cantidadElegida != null and estadioController.cantidadElegida != 0 and estadioController.festivalElegido.id != null and estadioController.diaElegido.id != null and estadioController.sectorElegido.id != null and estadioController.filaElegida.id != null and estadioController.asientosElegidos != null}">
			<f:facet name="footer">
				<p:commandButton id="siguientePasoBoton" value="Siguiente"
					actionListener="#{estadioController.generarFactura}"
					oncomplete="showEntradaWidget.show()"
					process="@this" partialSubmit="true" />

				<p:commandButton id="limparFormButton" immediate="true"
					value="Limpiar" icon="ui-icon-refresh"
					actionListener="#{estadioController.resetearSeleccion()}"
					process="@this" partialSubmit="true" update="elegirButacaPanel"
					oncomplete="window.location.reload()" style="margin:10px" />

			</f:facet>
		</h:panelGrid>
	</p:panel>
	<p:dialog id="showEntrada" widgetVar="showEntradaWidget"
		onHide="window.location.reload()" resizable="false" header="Entrada"
		closable="true" modal="true">
		<ui:include src="../../ver/verEntrada.xhtml" />
	</p:dialog>

</ui:composition>